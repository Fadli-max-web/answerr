<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pertanyaan Hati ðŸ’Œ</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg: linear-gradient(135deg,#ffe6f0,#fff);
    --card:#ffffff;
    --accent:#ff5fa2;
    --muted:#7a7a7a;
  }
  *{box-sizing:border-box}
  body{
    margin:0;font-family:'Poppins',sans-serif;background:var(--bg);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;
  }
  .container{
    width:100%;max-width:720px;background:transparent;border-radius:16px;padding:20px;
  }
  .card{
    background:var(--card);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,0.08);overflow:hidden;
  }
  header{
    padding:22px 24px;border-bottom:1px solid #f3f3f3;display:flex;align-items:center;gap:12px;
  }
  header h1{font-size:20px;margin:0;color:var(--accent)}
  .slides{padding:28px;min-height:320px;display:flex;align-items:center;justify-content:center;position:relative;}
  .slide{display:none;flex-direction:column;gap:16px;align-items:flex-start}
  .slide.active{display:flex}
  .q-title{font-weight:600;font-size:18px;color:#333}
  .q-desc{font-size:14px;color:var(--muted)}
  .input-text{width:100%;padding:12px;border-radius:10px;border:1px solid #eee;font-size:15px}
  .choices{display:flex;flex-direction:column;gap:8px;width:100%}
  .choice-btn{padding:12px;border-radius:10px;border:1px solid #eee;background:#fafafa;cursor:pointer;text-align:left}
  .controls{display:flex;justify-content:space-between;align-items:center;padding:18px;border-top:1px solid #f3f3f3}
  .btn{padding:10px 16px;border-radius:10px;border:none;cursor:pointer;font-weight:600}
  .btn-primary{background:var(--accent);color:white}
  .btn-ghost{background:transparent;border:1px solid #eee}
  .progress{height:8px;background:#f3f3f3;border-radius:8px;overflow:hidden;width:100%}
  .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#ff7fb5);width:0%}
  .center{display:flex;gap:8px;align-items:center}
  footer.note{font-size:13px;color:var(--muted);padding:12px 20px;text-align:center}
  /* popup */
  .popup{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.4);z-index:50}
  .popup.active{display:flex}
  .popup-card{background:white;padding:22px;border-radius:12px;min-width:260px;text-align:center;box-shadow:0 8px 30px rgba(0,0,0,0.15)}
  .heart{font-size:32px;color:var(--accent);margin-bottom:8px}
</style>
</head>
<body>
  <div class="container">
    <div class="card" role="main">
      <header>
        <div style="width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,#ffd1e8,#ffd8f0);display:flex;align-items:center;justify-content:center;">
          <span style="font-size:20px">ðŸ’Œ</span>
        </div>
        <div>
          <h1>Pertanyaan Hati</h1>
          <div style="font-size:13px;color:var(--muted)">Jawab jujur yaa kalo bisa jawabanya agak panjang yaa ðŸ’•</div>
        </div>
      </header>

      <div class="slides" id="slides">
        <!-- Slides akan di-inject lewat JS -->
      </div>

      <div class="controls">
        <button id="prevBtn" class="btn btn-ghost">Sebelumnya</button>
        <div style="flex:1;margin:0 12px;">
          <div class="progress" aria-hidden><i id="progressBar"></i></div>
        </div>
        <button id="nextBtn" class="btn btn-primary">Lanjut</button>
      </div>

      <footer class="note">10 pertanyaan â€¢ jawab jujur yaa</footer>
    </div>
  </div>

  <!-- popup terima kasih -->
  <div id="popup" class="popup" role="dialog" aria-modal="true">
    <div class="popup-card">
      <div class="heart">ðŸ’–</div>
      <div style="font-weight:700;font-size:16px">Makasih ya udah jujur</div>
      <div style="margin-top:8px;color:var(--muted)">Jawabanmu sudah tersimpan.</div>
      <div style="margin-top:12px"><button onclick="closePopup()" class="btn btn-primary">Tutup</button></div>
    </div>
  </div>

<script>
/* ======= GANTI INI: masukkan URL Web App dari Apps Script ===== */
const GS_ENDPOINT_URL = "https://script.google.com/macros/s/AKfycbznd6XldK3OtmF_5X-R6SxxrpzOjlZKQ08Tph2sDTd_pAYEn2fDNMUIBG5B8ujH4b53/exec"; // contoh: https://script.google.com/macros/s/AKfy.../exec
/* ============================================================ */

/* Pertanyaan default (bisa diedit) */
const QUESTIONS = [
  "Sebenernya kamu nyaman ga kalau kita sering chatan ga jelas gitu?",
  "Kamu lebih suka aku panggil kamu apa? ",
  "Menurut kamu aku orang yang gimana sih??",
  "Kamu lebih seneng mana, aku chat kamu duluan atau aku cuek?",
  "Kamu pengen kita lebih sering komunikasi?",
  "Kamu ngerasa ga kalo kita cocok?",
  "Apa yang bikin kamu nyaman sama aku?",
  "Kamu kangen aku ga? disaat apa kalo kangen nya?",
  "Kamu cemburu ga misal kamu liat aku di sekolah ada cewe tiba tiba deketin aku?",
  "Terakhir, kalo aku nanti semisal nembak kamu bakal dijawab apa??"
];

// state jawaban
const answers = new Array(QUESTIONS.length).fill("");

const slidesRoot = document.getElementById('slides');
const progressBar = document.getElementById('progressBar');
let currentIndex = 0;

/* buat slide HTML per pertanyaan */
function renderSlides() {
  slidesRoot.innerHTML = '';
  QUESTIONS.forEach((q, i) => {
    const slide = document.createElement('div');
    slide.className = 'slide' + (i === 0 ? ' active' : '');
    slide.dataset.index = i;
    slide.innerHTML = `
      <div style="width:100%">
        <div class="q-title">Pertanyaan ${i+1}</div>
        <div class="q-desc">${q}</div>
      </div>
      <div style="width:100%">
        <textarea class="input-text" id="input-${i}" placeholder="Tulis jawabanmu di sini..." rows="4">${answers[i] || ''}</textarea>
      </div>
    `;
    slidesRoot.appendChild(slide);
  });
  updateProgress();
}
renderSlides();

function showSlide(index) {
  const slides = document.querySelectorAll('.slide');
  slides.forEach(s => s.classList.remove('active'));
  const target = slides[index];
  if (target) target.classList.add('active');
  currentIndex = index;
  updateButtons();
  updateProgress();
  // fokus ke textarea
  const ta = document.getElementById(`input-${index}`);
  if (ta) ta.focus();
}

function updateButtons(){
  document.getElementById('prevBtn').disabled = (currentIndex === 0);
  if (currentIndex === QUESTIONS.length - 1) {
    document.getElementById('nextBtn').textContent = 'Kirim';
  } else {
    document.getElementById('nextBtn').textContent = 'Lanjut';
  }
}

/* simpan jawaban sementara dari textarea ke array */
function saveCurrentAnswer() {
  const ta = document.getElementById(`input-${currentIndex}`);
  if (ta) answers[currentIndex] = ta.value.trim();
}

function updateProgress(){
  const pct = Math.round(((currentIndex+1) / QUESTIONS.length) * 100);
  progressBar.style.width = pct + '%';
}

document.getElementById('prevBtn').addEventListener('click', () => {
  saveCurrentAnswer();
  if (currentIndex > 0) showSlide(currentIndex - 1);
});

document.getElementById('nextBtn').addEventListener('click', async () => {
  saveCurrentAnswer();
  if (currentIndex < QUESTIONS.length - 1) {
    showSlide(currentIndex + 1);
    return;
  }

  // terakhir -> kirim data
  // validasi minimal: minta isi minimal satu jawaban (bisa dikustom)
  const anyFilled = answers.some(a => a && a.length > 0);
  if (!anyFilled) {
    alert('Isi setidaknya satu jawaban terlebih dahulu ya :)');
    return;
  }

  const nextBtn = document.getElementById('nextBtn');
  nextBtn.disabled = true;
  nextBtn.textContent = 'Mengirim...';

  try {
    const payload = {
      timestamp: new Date().toLocaleString(),
      answers: answers.map(a => a || "")
    };

    const res = await fetch(GS_ENDPOINT_URL, {
      method: 'POST',
      mode: 'cors',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });

    const data = await res.json();
    if (data && data.status === 'success') {
      openPopup();
    } else {
      alert('Gagal menyimpan: ' + (data && data.message ? data.message : 'Unknown'));
    }

  } catch (err) {
    alert('Terjadi kesalahan saat mengirim: ' + err);
  } finally {
    nextBtn.disabled = false;
    nextBtn.textContent = 'Lanjut';
  }
});
function openPopup(){
  document.getElementById('popup').classList.add('active');
}
function closePopup(){
  document.getElementById('popup').classList.remove('active');
}

document.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
    return;
  }
  if (e.key === 'Enter' && !e.shiftKey) {
    const ta = document.activeElement;
    if (ta && ta.tagName === 'TEXTAREA') {
      e.preventDefault();
      saveCurrentAnswer();
      if (currentIndex < QUESTIONS.length - 1) showSlide(currentIndex+1);
    }
  }
});
</script>
</body>
</html>
